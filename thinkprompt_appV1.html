<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ThinkPrompt - Professional Prompt Builder</title>
<style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      color: #1e293b;
      line-height: 1.6;
      font-size: 16px;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    .page-wrapper {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0;
    }
    
    .brand-header {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 8px 16px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      color: white;
      text-align: center;
      border-radius: 16px 16px 0 0;
      margin-bottom: 0;
    }

    .new-logo {
      width: 100%;
      max-width: 200px;
      height: auto;
      margin: 0 auto 8px auto;
      display: block;
    }
    
    .workspace-section {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      margin-top: 0px;
      display: none;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 0px;
    }


    .container {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 0px;
    }
    
    .card {
      background: rgba(255, 255, 255, 0.95) !important;
      backdrop-filter: blur(10px) !important;
      border-radius: 0 !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-top: none !important;
      overflow: hidden !important;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1) !important;
      margin: 0 !important;
      margin-bottom: 0 !important;
      margin-top: 0 !important;
    }

    .card:last-child {
      border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 0 0 16px 16px !important;
    }

    /* COMPLETION STATUS STYLES */
    .completion-status-panel {
      background: linear-gradient(135deg, #1e293b, #374151);
      border: 3px solid #3b82f6;
      border-radius: 16px;
      padding: 20px;
      margin: 16px 20px;
      text-align: center;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      display: none;
      transition: all 0.3s ease;
    }

    .completion-status-panel.show {
      display: block;
    }

    /* SURGICAL FIX: Clickable status panels for generate functionality */
    .completion-status-panel.clickable {
      cursor: pointer;
      background: linear-gradient(135deg, #22c55e, #16a34a) !important;
      border-color: #22c55e !important;
      user-select: none;
    }

    .completion-status-panel.clickable:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(34, 197, 94, 0.3);
      background: linear-gradient(135deg, #16a34a, #15803d) !important;
    }

    .completion-status-panel.clickable .status-level {
      color: #ffffff !important;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    .completion-status-panel.clickable .status-message {
      color: #ffffff !important;
      opacity: 0.95;
    }

    .status-display {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
    }

    .status-icon {
      font-size: 32px;
      line-height: 1;
    }

    .status-content {
      text-align: left;
    }

    .status-level {
      font-size: 20px;
      font-weight: 900;
      font-family: 'Impact', 'Arial Black', sans-serif;
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    .status-level.status-none { color: #6b7280; }
    .status-level.status-incomplete { color: #ef4444; }
    .status-level.status-ready { color: #eab308; }
    .status-level.status-optimized { color: #10b981; }

    .status-message {
      font-size: 13px;
      font-weight: 600;
      color: #e5e7eb;
      margin-top: 4px;
      line-height: 1.3;
    }

    /* COPY SUCCESS MESSAGE */
    .copy-success {
      position: fixed;
      top: 100px;
      right: 20px;
      background: #10b981;
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 600;
      z-index: 2000;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .copy-success.show {
      transform: translateX(0);
    }

    /* SAVE MODAL STYLES */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    .modal-dialog {
      background: white;
      border-radius: 16px;
      max-width: 400px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
    }
    
    /* SECTION 1 STYLES */
    .categories-section {
      padding: 0;
    }

    .subsection {
      border-bottom: 1px solid #374151;
    }

    .subsection-header {
      background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
      padding: 16px 28px;
      border-bottom: 1px solid #374151;
    }

    .subsection-title {
      color: white;
      font-family: 'Impact', 'Arial Black', sans-serif;
      font-size: 16px;
      font-weight: 900;
      letter-spacing: 0.5px;
      margin: 0 0 6px 0;
      text-align: center;
    }

    .subsection-description {
      color: #94a3b8;
      font-size: 13px;
      font-weight: 500;
      margin: 0;
      opacity: 0.9;
    }

    .category-tabs-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 20px 24px;
      border-bottom: 1px solid #374151;
      position: relative;
    }
    
    .category-tabs-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .category-tabs-container::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .category-tabs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: 12px;
      max-width: 900px;
      margin: 0 auto;
    }
    
    .category-tab {
      padding: 14px 18px;
      border: 2px solid #374151;
      border-radius: 10px;
      background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
      color: #22c55e;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      min-height: 50px;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.3);
    }

    .category-tab::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(34, 197, 94, 0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }

    .category-tab:hover::before {
      transform: translateX(100%);
    }

    .category-tab:hover {
      border-color: #22c55e;
      color: #ffffff;
      background: linear-gradient(135deg, #2d2d2d, #404040);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(34, 197, 94, 0.2);
    }

    .category-tab.active {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #000000;
      border-color: #22c55e;
      box-shadow: 0 6px 20px rgba(34, 197, 94, 0.4);
      transform: translateY(-2px);
    }

    .category-tab.active::before {
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    }

    /* STARTER TABS */
    .starter-tabs-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 20px 24px;
      border-bottom: 1px solid #374151;
      position: relative;
    }
    
    .starter-tabs-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .starter-tabs-container::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .starter-tabs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: 12px;
      max-width: 900px;
      margin: 0 auto;
    }
    
    .starter-tab {
      padding: 14px 18px;
      border: 2px solid #374151;
      border-radius: 10px;
      background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
      color: #22c55e;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      min-height: 50px;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.3);
    }

    .starter-tab::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(34, 197, 94, 0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }

    .starter-tab:hover::before {
      transform: translateX(100%);
    }

    .starter-tab:hover {
      border-color: #22c55e;
      color: #ffffff;
      background: linear-gradient(135deg, #2d2d2d, #404040);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(34, 197, 94, 0.2);
    }

    .starter-tab.active {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #000000;
      border-color: #22c55e;
      box-shadow: 0 6px 20px rgba(34, 197, 94, 0.4);
      transform: translateY(-2px);
    }

    .starter-tab.active::before {
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    }

    /* TEMPLATES SECTION */
    .templates-section {
      padding: 0;
      display: none;
    }
    
    .templates-section.show {
      display: block;
    }
    
    .templates-section .templates-header,
    .content-section .templates-header {
      background: linear-gradient(135deg, #000000, #1a1a1a) !important;
      padding: 20px 28px;
      border-top: 1px solid #374151;
      text-align: center;
      position: relative;
    }
    
    .templates-section .templates-header::before,
    .content-section .templates-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #22c55e, transparent);
    }
    
    .templates-section .templates-title,
    .content-section .templates-title {
      color: #ffffff !important;
      font-family: 'Impact', 'Arial Black', sans-serif;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: 1px;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
      margin: 0;
    }
    
    .templates-content {
      padding: 20px;
      background: rgba(255, 255, 255, 0.95);
    }
    
    .templates-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
    }
    
    .template-card {
      padding: 16px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      background: white;
      position: relative;
    }
    
    .template-card:hover {
      border-color: #dc2626;
      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.1);
    }
    
    .template-card.selected {
      border-color: #dc2626;
      background: #fef2f2;
    }
    
    .template-name {
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 4px;
    }
    
    .template-desc {
      font-size: 13px;
      color: #64748b;
    }

    /* FORM SECTION */
    .form-section {
      padding: 32px;
      display: none;
      background: rgba(255, 255, 255, 0.95);
    }

    .form-section.show {
      display: block;
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-label {
      display: block;
      font-weight: 600;
      color: #374151;
      margin-bottom: 8px;
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* SURGICAL FIX: Red asterisks for Goal, Context, and Tone fields */
    #goalGroup .form-label::after,
    #contextGroup .form-label::after,
    #toneGroup .form-label::after {
      content: "*";
      color: #dc2626;
      font-size: 20px;
      font-weight: 900;
    }

    .form-textarea {
      width: 100%;
      padding: 16px 18px;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      font-size: 16px;
      resize: vertical;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      font-family: inherit;
    }

    .form-textarea.form-select {
      min-height: 60px;
      resize: none;
      appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 18px center;
      background-repeat: no-repeat;
      background-size: 20px;
      padding-right: 50px;
    }

    .form-textarea:focus {
      outline: none;
      border-color: #dc2626;
      box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
      background: rgba(255, 255, 255, 0.98);
    }

    /* Field sizing */
    #goal, #tone { min-height: 60px; }
    #context { min-height: 80px; }
    #role, #constraints { min-height: 70px; }
    #examples { min-height: 90px; }

    .form-hint {
      font-size: 14px;
      color: #6b7280;
      margin-top: 6px;
      line-height: 1.4;
      font-style: italic;
    }

    /* Field Groups */
    .form-group {
      display: none;
    }

    .form-group.show {
      display: block;
    }
    
    .welcome-state {
      padding: 60px 24px;
      text-align: center;
      color: #64748b;
    }
    
    .welcome-icon {
      font-size: 48px;
      margin-bottom: 20px;
      opacity: 0.6;
    }
    
    .welcome-icon svg {
      width: 48px;
      height: 48px;
    }
    
    .welcome-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
      color: #374151;
    }
    
    .welcome-text {
      font-size: 14px;
      line-height: 1.5;
    }

    /* WORKSPACE SECTION STYLES - FIXED LAYOUT */
    .workspace-section {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      margin-top: 16px;
      display: none;
    }

    .workspace-section.show {
      display: block;
    }

    /* WORKSPACE TITLE SECTION - Following templates pattern */
    .workspace-title-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 20px 28px;
      text-align: center;
      position: relative;
      border-bottom: 1px solid #374151;
    }

    .workspace-title-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #3b82f6, transparent);
    }

    .workspace-title {
      color: #ffffff;
      font-family: 'Impact', 'Arial Black', sans-serif;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: 1px;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
      margin: 0;
    }

    .workspace-description {
      color: #94a3b8;
      font-size: 14px;
      font-weight: 500;
      margin-top: 8px;
      opacity: 0.9;
    }

    /* WORKSPACE ACTIONS SECTION - Following category tabs pattern */
    .workspace-actions-container {
      background: linear-gradient(135deg, #000000, #1a1a1a);
      padding: 24px;
      border-bottom: 1px solid #374151;
      position: relative;
    }

    .workspace-actions-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #3b82f6, transparent);
    }

    .workspace-actions-container::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, #3b82f6, transparent);
    }

    .workspace-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      max-width: 900px;
      margin: 0 auto;
    }

    .action-btn {
      padding: 14px 18px;
      border: 2px solid #374151;
      border-radius: 10px;
      background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
      color: #3b82f6;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      min-height: 50px;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.3);
    }

    .action-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(59, 130, 246, 0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }

    .action-btn:hover::before {
      transform: translateX(100%);
    }

    .action-btn:hover {
      border-color: #3b82f6;
      color: #ffffff;
      background: linear-gradient(135deg, #2d2d2d, #404040);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.2);
    }

    .action-btn.primary {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      color: #ffffff;
      border-color: #3b82f6;
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
      transform: translateY(-2px);
    }

    .action-btn.primary:hover {
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      border-color: #2563eb;
    }

    .workspace-content {
      padding: 32px 28px;
      min-height: 200px;
    }

    .prompt-display {
      width: 100%;
      min-height: 300px;
      padding: 20px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 16px;
      line-height: 1.6;
      color: #1e293b;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      resize: vertical;
      white-space: pre-wrap;
      overflow-y: auto;
    }

    .prompt-display:focus {
      outline: none;
      border-color: #dc2626;
      box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
      background: rgba(255, 255, 255, 0.95);
    }

    .workspace-empty {
      text-align: center;
      padding: 60px 24px;
      color: #64748b;
    }

    .workspace-empty-icon {
      font-size: 48px;
      margin-bottom: 20px;
      opacity: 0.6;
    }

    .workspace-empty-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
      color: #374151;
    }

    .workspace-empty-text {
      font-size: 14px;
      line-height: 1.5;
    }

    .starter-prompt-card {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 16px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      /* MOBILE FIX: Add touch handling for iPad/mobile */
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }

    .starter-prompt-card:hover {
      border-color: #3b82f6;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
      transform: translateY(-1px);
    }

    /* MOBILE FIX: Remove hover effects on touch devices */
    @media (hover: none) and (pointer: coarse) {
      .starter-prompt-card:hover {
        border-color: #e2e8f0;
        box-shadow: none;
        transform: none;
      }
      
      .starter-prompt-card:active {
        border-color: #3b82f6;
        background: #f8fafc;
      }
    }

    /* SVG Icon Styles */
    .icon {
      width: 16px;
      height: 16px;
      stroke: currentColor;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    /* LIBRARY SECTION STYLES */
    #libraryList {
      max-height: 400px;
      min-height: 200px;
      overflow-y: auto;
    }

    .prompt-item {
      display: flex;
      align-items: center;
      padding: 12px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      margin-bottom: 8px;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
    }

    .prompt-item:hover {
      border-color: #3b82f6;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
    }

    .prompt-item.highlight-new {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: white;
      border-color: #22c55e;
      box-shadow: 0 4px 16px rgba(34, 197, 94, 0.3);
      animation: highlightPulse 2s ease-in-out;
    }

    .prompt-item.highlight-new .prompt-title {
      color: white;
    }

    .prompt-item.highlight-new .prompt-date {
      color: rgba(255, 255, 255, 0.9);
    }

    @keyframes highlightPulse {
      0% {
        box-shadow: 0 4px 16px rgba(34, 197, 94, 0.3);
      }
      50% {
        box-shadow: 0 8px 32px rgba(34, 197, 94, 0.6);
        transform: translateY(-2px);
      }
      100% {
        box-shadow: 0 4px 16px rgba(34, 197, 94, 0.3);
      }
    }

    .prompt-checkbox {
      margin-right: 12px;
    }

    .prompt-info {
      flex: 1;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      transition: background-color 0.2s;
    }

    .prompt-info:hover {
      background-color: rgba(59, 130, 246, 0.05);
    }

    /* MOBILE/TABLET FIX: Remove hover on touch devices */
    @media (hover: none) and (pointer: coarse) {
      .prompt-info {
        cursor: default;
      }
      
      .prompt-info:hover {
        background-color: transparent;
      }
      
      .prompt-info:active {
        background-color: rgba(59, 130, 246, 0.1);
      }
    }

    .prompt-title {
      font-weight: 600;
      color: #1e293b;
    }

    .prompt-date {
      font-size: 12px;
      color: #64748b;
      margin-top: 4px;
    }

    /* RESPONSIVE */
    @media (max-width: 768px) {
      .page-wrapper {
        padding: 24px;
      }
      
      .brand-header {
        padding: 12px 24px;
        border-radius: 16px;
      }
      
      .new-logo {
        max-width: 400px;
      }
      
      .category-tabs, .starter-tabs {
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 10px;
      }

      .status-display { 
        flex-direction: column; 
        gap: 12px; 
      }
      .status-content { 
        text-align: center; 
      }
      .status-level { 
        font-size: 18px; 
      }

      .workspace-actions {
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 10px;
      }
    }
</style>
</head>
<body>
<div class="page-wrapper" style="max-width: 1200px; margin: 0 auto; padding: 8px;">
  <!-- COPY SUCCESS MESSAGE -->
  <div class="copy-success" id="copySuccess">
    <svg class="icon" viewBox="0 0 24 24"><polyline points="20,6 9,17 4,12"></polyline></svg>
    Copied to clipboard!
  </div>

  <!-- HEADER WITH NEW LOGO -->
  <header class="brand-header">
    <svg class="new-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 200" role="img" aria-label="ThinkPrompt logo">
      <defs>
        <!-- Metallic gray gradient -->
        <linearGradient id="textGradGray" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#d1d5db"/>
          <stop offset="100%" stop-color="#374151"/>
        </linearGradient>
        <!-- Drop shadow -->
        <filter id="textShadow" x="-20%" y="-20%" width="140%" height="140%">
          <feDropShadow dx="2" dy="2" stdDeviation="4" flood-color="#000000" flood-opacity=".7"/>
        </filter>
      </defs>
      <!-- Lightbulb outline (slightly taller than text) -->
      <g transform="translate(20,20) scale(1.08)"
         stroke="#22c55e" stroke-width="6"
         fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path d="M64 16 C44 16,28 32,28 52
                 c0 14,9 26,20 32
                 v10 h32 v-10
                 c11-6,20-18,20-32
                 C100 32,84 16,64 16 Z"/>
        <path d="M64 56 l-10 12 M64 56 l10 12 M64 56 v16"/>
        <line x1="46" y1="100" x2="82" y2="100"/>
        <line x1="48" y1="112" x2="80" y2="112"/>
        <line x1="52" y1="124" x2="76" y2="124"/>
      </g>
      <!-- One-line wordmark -->
      <text x="160" y="120"
            font-family="-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Inter,Helvetica,Arial,sans-serif"
            font-size="88" font-weight="900" letter-spacing="-0.8px"
            fill="url(#textGradGray)"
            filter="url(#textShadow)">
        ThinkPrompt
      </text>
    </svg>
  </header>

  <div class="container">
    <!-- SECTION 1: TEMPLATE SELECTION AND STARTER PROMPTS -->
    <section class="card">
      <div class="categories-section">
        
        <!-- SUBSECTION A: Templates for Creating Effective Prompts -->
        <div class="subsection">
          <div class="subsection-header">
            <h3 class="subsection-title">TEMPLATES FOR CREATING EFFECTIVE PROMPTS</h3>
            <p class="subsection-description">Build custom prompts using professional templates with guided forms</p>
          </div>
          <div class="category-tabs-container">
            <div class="category-tabs">
              <button class="category-tab" data-category="email">
                <svg class="icon" viewbox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                Email
              </button>
              <button class="category-tab" data-category="creative">
                <svg class="icon" viewbox="0 0 24 24"><path d="M12 19l7-7 3 3-7 7-3-3z"></path><path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path><path d="m2 2 7.586 7.586"></path><circle cx="11" cy="11" r="2"></circle></svg>
                Creative
              </button>
              <button class="category-tab" data-category="video">
                <svg class="icon" viewbox="0 0 24 24"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect height="14" rx="2" ry="2" width="15" x="1" y="5"></rect></svg>
                Video
              </button>
              <button class="category-tab" data-category="social">
                <svg class="icon" viewbox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
                Social
              </button>
              <button class="category-tab" data-category="career">
                <svg class="icon" viewbox="0 0 24 24"><rect height="14" rx="2" ry="2" width="20" x="2" y="7"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>
                Career
              </button>
              <button class="category-tab" data-category="business">
                <svg class="icon" viewbox="0 0 24 24"><path d="M2 20h20"></path><path d="M5 20V9l5-5 5 5v11"></path><path d="M9 9v11"></path><path d="M15 9v11"></path></svg>
                Business
              </button>
              <button class="category-tab" data-category="custom">
                <svg class="icon" viewbox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6m11-7h-6m-6 0H1m15.5-6.5L17 7m-10 5L3.5 8.5m0 7L7 17m10-5l3.5 3.5"></path></svg>
                Custom
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- TEMPLATES -->
      <div class="templates-section" id="templatesSection">
        <div class="templates-header">
          <h3 class="templates-title">SELECT A CATEGORY ABOVE</h3>
        </div>
        <div class="templates-content">
          <div class="welcome-state">
            <div class="welcome-icon">
              <svg fill="none" height="48" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="48"><line x1="12" x2="12" y1="19" y2="5"></line><polyline points="5,12 12,5 19,12"></polyline></svg>
            </div>
            <h3 class="welcome-title">Choose a Category to Begin</h3>
            <p class="welcome-text">Select from the categories above to view professional templates and get started with your prompt.</p>
          </div>
        </div>
      </div>

      <!-- SUBSECTION B: Library of Ready-to-Use Prompts -->
      <div class="subsection">
        <div class="subsection-header">
          <h3 class="subsection-title">LIBRARY OF READY-TO-USE PROMPTS</h3>
          <p class="subsection-description">Browse and use professional starter prompts - copy, customize, or save to your library</p>
        </div>
        <div class="starter-tabs-container">
          <div class="starter-tabs">
            <button class="starter-tab active" data-category="all" data-mode="starter">
              <svg class="icon" viewBox="0 0 24 24"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>
              All
            </button>
            <button class="starter-tab" data-category="email" data-mode="starter">
              <svg class="icon" viewbox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
              Email
            </button>
            <button class="starter-tab" data-category="creative" data-mode="starter">
              <svg class="icon" viewbox="0 0 24 24"><path d="M12 19l7-7 3 3-7 7-3-3z"></path><path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path><path d="m2 2 7.586 7.586"></path><circle cx="11" cy="11" r="2"></circle></svg>
              Creative
            </button>
            <button class="starter-tab" data-category="video" data-mode="starter">
              <svg class="icon" viewbox="0 0 24 24"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect height="14" rx="2" ry="2" width="15" x="1" y="5"></rect></svg>
              Video
            </button>
            <button class="starter-tab" data-category="social" data-mode="starter">
              <svg class="icon" viewbox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
              Social
            </button>
            <button class="starter-tab" data-category="career" data-mode="starter">
              <svg class="icon" viewbox="0 0 24 24"><rect height="14" rx="2" ry="2" width="20" x="2" y="7"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>
              Career
            </button>
            <button class="starter-tab" data-category="business" data-mode="starter">
              <svg class="icon" viewbox="0 0 24 24"><path d="M2 20h20"></path><path d="M5 20V9l5-5 5 5v11"></path><path d="M9 9v11"></path><path d="M15 9v11"></path></svg>
              Business
            </button>
          </div>
        </div>
      </div>

      <!-- DYNAMIC CONTENT AREA -->
      <div class="content-section" id="contentSection">
        <!-- Empty on page load, populated by JavaScript -->
      </div>
    </section>

    <!-- SECTION 2: GUIDED FORM SYSTEM -->
    <section class="card">
      <!-- COMPLETION STATUS PANEL TOP -->
      <div class="completion-status-panel" id="completionStatus">
        <div class="status-display">
          <span class="status-icon" id="statusIcon">⚪</span>
          <div class="status-content">
            <div class="status-level status-none" id="statusLevel">WAITING</div>
            <div class="status-message" id="statusMessage">Select a template to begin building your prompt</div>
          </div>
        </div>
      </div>

      <!-- FORM SECTION -->
      <div class="form-section" id="formSection">
        <div style="text-align: center; padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; margin-bottom: 24px;">
          <strong>THINK Methodology: T-Thought | H-How | I-Improve | N-Needs met | K-Keep</strong>
        </div>
        <div class="form-group show" id="goalGroup">
          <label class="form-label" for="goal">
            <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>
            Goal
          </label>
          <textarea class="form-textarea" id="goal" placeholder="What do you want the AI to accomplish?"></textarea>
          <div class="form-hint" id="goalHint">Be specific about your desired outcome and success criteria</div>
        </div>

        <div class="form-group show" id="contextGroup">
          <label class="form-label" for="context">
            <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg>
            Context
          </label>
          <textarea class="form-textarea" id="context" placeholder="Provide background information..."></textarea>
          <div class="form-hint" id="contextHint">Provide background: audience, industry, constraints, current situation</div>
        </div>

        <div class="form-group show" id="toneGroup">
          <label class="form-label" for="tone">
            <svg class="icon" viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
            Tone/Style
          </label>
          <textarea class="form-textarea" id="tone" placeholder="Professional, casual, witty..."></textarea>
          <div class="form-hint" id="toneHint">Define voice and personality that matches your audience</div>
        </div>

        <div class="form-group" id="roleGroup">
          <label class="form-label" for="role">
            <svg class="icon" viewBox="0 0 24 24"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="m22 21-3-3m0 0a2 2 0 0 0-3-3 2 2 0 0 0-3 3c0 1 1 2 2 2s2-1 2-2"></path></svg>
            Act As
          </label>
          <textarea class="form-textarea" id="role" placeholder="You are a marketing expert, technical writer..."></textarea>
          <div class="form-hint" id="roleHint">Define what type of expert the AI should be</div>
        </div>

        <div class="form-group" id="formatGroup">
          <label class="form-label" for="format">
            <svg class="icon" viewBox="0 0 24 24"><rect width="18" height="7" x="3" y="3" rx="1"></rect><rect width="9" height="7" x="3" y="14" rx="1"></rect><rect width="5" height="7" x="16" y="14" rx="1"></rect></svg>
            Output Format
          </label>
          <select class="form-textarea form-select" id="format">
            <option value="">Choose format...</option>
            <option value="paragraph">Paragraph</option>
            <option value="list">List</option>
            <option value="table">Table</option>
            <option value="code">Code block</option>
            <option value="dialogue">Dialogue</option>
            <option value="step-by-step">Step-by-step</option>
          </select>
          <div class="form-hint" id="formatHint">Structure affects readability and usability of the response</div>
        </div>

        <div class="form-group" id="constraintsGroup">
          <label class="form-label" for="constraints">
            <svg class="icon" viewBox="0 0 24 24"><path d="M9 12l2 2 4-4"></path><path d="M21 12c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1"></path><path d="M3 12c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1"></path><path d="M12 21c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1"></path><path d="M12 3c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1"></path></svg>
            Requirements
          </label>
          <textarea class="form-textarea" id="constraints" placeholder="e.g., Keep under 100 words, use simple language..."></textarea>
          <div class="form-hint" id="constraintsHint">Set clear boundaries and requirements</div>
        </div>

        <div class="form-group" id="examplesGroup">
          <label class="form-label" for="examples">
            <svg class="icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>
            Examples
          </label>
          <textarea class="form-textarea" id="examples" placeholder="Show sample outputs to guide the AI..."></textarea>
          <div class="form-hint" id="examplesHint">Show 2-3 concrete examples of exactly what you want</div>
        </div>
      </div>

      <!-- COMPLETION STATUS PANEL BOTTOM - MOVED TO SAME LEVEL AS TOP -->
      <div class="completion-status-panel" id="completionStatusBottom" style="margin: 16px 20px;">
        <div class="status-display">
          <span class="status-icon" id="statusIconBottom">⚪</span>
          <div class="status-content">
            <div class="status-level status-none" id="statusLevelBottom">WAITING</div>
            <div class="status-message" id="statusMessageBottom">Select a template to begin building your prompt</div>
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION 3: PROMPT MANAGEMENT -->
    <section class="card">
      <div class="workspace-title-container">
        <h2 class="workspace-title">Prompt Management</h2>
        <p class="workspace-description">Save and manage your custom prompts</p>
      </div>
      <div class="workspace-actions-container">
        <div class="workspace-actions">
          <button class="action-btn" onclick="bringYourOwnPrompts()">
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17,8 12,3 7,8"/>
              <line x1="12" x2="12" y1="3" y2="15"/>
            </svg>
            Bring Your Own Prompts
          </button>
          <button class="action-btn primary" onclick="showLibrary()">
            <svg class="icon" viewBox="0 0 24 24">
              <rect width="7" height="7" x="3" y="3" rx="1"/>
              <rect width="7" height="7" x="14" y="3" rx="1"/>
              <rect width="7" height="7" x="14" y="14" rx="1"/>
              <rect width="7" height="7" x="3" y="14" rx="1"/>
            </svg>
            Library
          </button>
        </div>
      </div>
    </section>

    <!-- WORKSPACE SECTION - FIXED LAYOUT -->
    <section class="workspace-section" id="workspaceSection">
      <div class="workspace-title-container">
        <h2 class="workspace-title">Prompt Workspace</h2>
        <p class="workspace-description">Edit, copy, export, or save your generated prompts</p>
        <button onclick="document.getElementById('workspaceSection').classList.remove('show')" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 24px; cursor: pointer; line-height: 1;">&times;</button>
      </div>
      <div class="workspace-actions-container">
        <div class="workspace-actions">
          <button class="action-btn" onclick="copyPrompt()">
            <svg class="icon" viewBox="0 0 24 24">
              <rect width="14" height="14" x="8" y="8" rx="2" ry="2"/>
              <path d="m4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>
            </svg>
            Copy
          </button>
          <button class="action-btn" onclick="editPrompt()">
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            Edit
          </button>
          <button class="action-btn" onclick="exportPrompt()">
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7,10 12,15 17,10"/>
              <line x1="12" x2="12" y1="15" y2="3"/>
            </svg>
            Export
          </button>
          <button class="action-btn" onclick="saveCurrentPrompt()">
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
              <polyline points="17,21 17,13 7,13 7,21"/>
              <polyline points="7,3 7,8 15,8"/>
            </svg>
            Save
          </button>
          <button class="action-btn primary" onclick="showLibrary()">
            <svg class="icon" viewBox="0 0 24 24">
              <rect width="7" height="7" x="3" y="3" rx="1"/>
              <rect width="7" height="7" x="14" y="3" rx="1"/>
              <rect width="7" height="7" x="14" y="14" rx="1"/>
              <rect width="7" height="7" x="3" y="14" rx="1"/>
            </svg>
            Library
          </button>
        </div>
      </div>
      <div class="workspace-content">
        <div class="prompt-display" id="promptDisplay" contenteditable="true">
          <div class="workspace-empty">
            <div class="workspace-empty-icon">💭</div>
            <h3 class="workspace-empty-title">No Prompt Generated Yet</h3>
            <p class="workspace-empty-text">Complete the form above and click generate to see your custom prompt here.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- LIBRARY SECTION -->
    <section class="card" id="librarySection" style="display: none;">
      <div class="workspace-title-container">
        <h2 class="workspace-title">My Saved Prompts</h2>
        <p class="workspace-description">Search, load, and manage your saved prompts</p>
        <button onclick="document.getElementById('librarySection').style.display='none'" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 24px; cursor: pointer; line-height: 1;">&times;</button>
      </div>
      <div style="padding: 32px;">
        <input type="text" class="form-textarea" id="librarySearch" placeholder="Search prompts..." style="margin-bottom: 16px;" />
        <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px; margin-bottom: 16px; font-size: 13px; color: #6b7280; text-align: center;">
          Click any prompt to load it into the workspace
        </div>
        <button class="action-btn" id="deleteSelected" style="background: #ef4444; border-color: #ef4444; color: white; margin-bottom: 20px;">
          <svg class="icon" viewBox="0 0 24 24" style="color: white;">
            <polyline points="3,6 5,6 21,6"></polyline>
            <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
            <line x1="10" x2="10" y1="11" y2="17"></line>
            <line x1="14" x2="14" y1="11" y2="17"></line>
          </svg>
          Delete Selected
        </button>
        <div id="libraryList"></div>
      </div>
    </section>
  </div>
</div>

    <!-- SAVE MODAL OVERLAY -->
    <div class="modal-overlay" id="saveModalOverlay" style="display: none;">
      <div class="modal-dialog">
        <div class="workspace-title-container">
          <h2 class="workspace-title">Save Prompt</h2>
          <p class="workspace-description">Save your prompt to the library</p>
          <button onclick="closeSaveModal()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 24px; cursor: pointer; line-height: 1;">&times;</button>
        </div>
        <div style="padding: 32px;">
          <div style="margin-bottom: 16px;">
            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Title *</label>
            <input type="text" id="saveTitle" placeholder="Enter prompt title..." class="form-textarea" style="min-height: 60px; resize: none;">
          </div>
          <div style="margin-bottom: 24px;">
            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #374151;">Description</label>
            <textarea id="saveDescription" placeholder="Brief description (optional)..." class="form-textarea" style="height: 80px;"></textarea>
          </div>
          <div style="display: flex; gap: 12px; justify-content: flex-end;">
            <button onclick="closeSaveModal()" style="padding: 12px 24px; border: 1px solid #d1d5db; background: white; color: #374151; border-radius: 8px; cursor: pointer;">Cancel</button>
            <button onclick="confirmSave()" class="action-btn primary" style="padding: 12px 24px; border-radius: 8px;">Save Prompt</button>
          </div>
        </div>
      </div>
    </div>



<script>
  // SURGICAL FIX: Add success message function
  function showCopySuccess(message) {
    const successMessage = document.getElementById('copySuccess');
    successMessage.innerHTML = `
      <svg class="icon" viewBox="0 0 24 24"><polyline points="20,6 9,17 4,12"></polyline></svg>
      ${message}
    `;
    successMessage.classList.add('show');
    setTimeout(() => {
      successMessage.classList.remove('show');
    }, 2000);
  }

  // ===== SAVE FUNCTIONALITY =====
  function saveCurrentPrompt() {
    const promptDisplay = document.getElementById('promptDisplay');
    const promptText = (promptDisplay.textContent || promptDisplay.innerText)
      .replace('💭No Prompt Generated YetComplete the form above and click generate to see your custom prompt here.', '')
      .trim();
    
    if (!promptText || promptText.length === 0) {
      alert('No prompt to save. Please generate or load a prompt first.');
      return;
    }
    
    // Show save modal overlay
    document.getElementById('saveModalOverlay').style.display = 'flex';
    document.getElementById('saveTitle').focus();
  }

  function closeSaveModal() {
    document.getElementById('saveModalOverlay').style.display = 'none';
    document.getElementById('saveTitle').value = '';
    document.getElementById('saveDescription').value = '';
  }

  function confirmSave() {
    const title = document.getElementById('saveTitle').value.trim();
    const description = document.getElementById('saveDescription').value.trim();
    
    if (!title) {
      alert('Please enter a title for your prompt.');
      document.getElementById('saveTitle').focus();
      return;
    }
    
    // Get existing saved prompts
    const savedPrompts = JSON.parse(localStorage.getItem('thinkprompt_saved') || '[]');
    
    // Check for duplicate titles
    if (savedPrompts.some(p => p.title.toLowerCase() === title.toLowerCase())) {
      alert('A prompt with that title already exists. Please choose a different title.');
      document.getElementById('saveTitle').focus();
      return;
    }
    
    // Get current prompt content
    const promptDisplay = document.getElementById('promptDisplay');
    const promptText = (promptDisplay.textContent || promptDisplay.innerText)
      .replace('No Prompt Generated YetComplete the form above and click generate to see your custom prompt here.', '')
      .trim();
    
    // Create new prompt object
    const newPromptId = Date.now();
    const newPrompt = {
      id: newPromptId,
      title: title,
      description: description || 'Saved prompt',
      content: promptText,
      created: new Date().toLocaleDateString(),
      timestamp: new Date().toISOString()
    };
    
    // Save to localStorage
    savedPrompts.push(newPrompt);
    localStorage.setItem('thinkprompt_saved', JSON.stringify(savedPrompts));
    
    // Close modal and show success
    closeSaveModal();
    showCopySuccess('Prompt saved successfully!');
    
    // Show library with highlighted new prompt
    showLibrary(newPromptId);
  }

  // ===== BRING YOUR OWN PROMPTS FUNCTIONALITY =====
  function bringYourOwnPrompts() {
    console.log('Opening workspace for custom prompt...');
    
    // Clear workspace and make it ready for user input
    const promptDisplay = document.getElementById('promptDisplay');
    promptDisplay.innerHTML = '<p style="color: #6b7280; font-style: italic; padding: 20px; text-align: center;">Paste or type your prompt here...</p>';
    
    // Hide other sections and modal
    document.getElementById('formSection')?.classList.remove('show');
    document.getElementById('completionStatus')?.classList.remove('show');
    document.getElementById('completionStatusBottom')?.classList.remove('show');
    document.getElementById('templatesSection')?.classList.remove('show');
    document.getElementById('librarySection').style.display = 'none';
    
    const saveModal = document.getElementById('saveModalOverlay');
    if (saveModal) saveModal.style.display = 'none';
    
    // Show workspace
    document.getElementById('workspaceSection').classList.add('show');
    
    // Focus on the workspace for immediate editing
    setTimeout(() => {
      promptDisplay.focus();
      document.getElementById('workspaceSection').scrollIntoView({ behavior: 'smooth' });
    }, 100);
  }

  // ===== LIBRARY FUNCTIONS =====
  function showLibrary(newItemId = null) {
    console.log('📚 Opening library...');
    
    // Hide other sections and modal
    document.getElementById('formSection')?.classList.remove('show');
    document.getElementById('completionStatus')?.classList.remove('show');
    document.getElementById('completionStatusBottom')?.classList.remove('show');
    document.getElementById('templatesSection')?.classList.remove('show');
    document.getElementById('workspaceSection')?.classList.remove('show');
    
    const saveModal = document.getElementById('saveModalOverlay');
    if (saveModal) saveModal.style.display = 'none';
    
    // Clear content section
    ContentManager.updateContentSection('');
    
    // Show library
    document.getElementById('librarySection').style.display = 'block';
    
    // Render prompts list with optional highlighting
    renderPromptsList('', newItemId);
    
    // Scroll to library
    setTimeout(() => {
      document.getElementById('librarySection').scrollIntoView({ behavior: 'smooth' });
    }, 100);
  }

  function renderPromptsList(searchTerm = '', newItemId = null) {
    const savedPrompts = JSON.parse(localStorage.getItem('thinkprompt_saved') || '[]');
    const libraryList = document.getElementById('libraryList');
    
    if (savedPrompts.length === 0) {
      libraryList.innerHTML = `
        <div style="text-align: center; padding: 40px; color: #64748b;">
          <div style="font-size: 48px; margin-bottom: 16px;">📂</div>
          <h3>No saved prompts yet</h3>
          <p>Start building prompts and save them to see them here.</p>
        </div>
      `;
      return;
    }
    
    // Filter prompts based on search term
    const filteredPrompts = savedPrompts.filter(prompt => 
      prompt.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
      prompt.content.toLowerCase().includes(searchTerm.toLowerCase())
    );
    
    libraryList.innerHTML = filteredPrompts.map(prompt => {
      const isNewItem = newItemId && prompt.id.toString() === newItemId.toString();
      const highlightClass = isNewItem ? ' highlight-new' : '';
      
      return `
        <div class="prompt-item${highlightClass}" ${isNewItem ? `id="new-prompt-${prompt.id}"` : ''}>
          <div class="prompt-checkbox-area" onclick="event.stopPropagation()">
            <input type="checkbox" class="prompt-checkbox" data-prompt-id="${prompt.id}">
          </div>
          <div class="prompt-info" onclick="loadPromptFromLibrary('${prompt.id}')">
            <div class="prompt-title">${prompt.title}</div>
            <div class="prompt-date">Saved ${prompt.created}</div>
          </div>
        </div>
      `;
    }).join('');
    
    // Scroll to and remove highlight after animation
    if (newItemId) {
      setTimeout(() => {
        const newElement = document.getElementById(`new-prompt-${newItemId}`);
        if (newElement) {
          newElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
          
          // Remove highlight class after animation completes
          setTimeout(() => {
            newElement.classList.remove('highlight-new');
          }, 2000);
        }
      }, 100);
    }
  }

  function initializeLibrarySearch() {
    const searchInput = document.getElementById('librarySearch');
    if (searchInput) {
      searchInput.addEventListener('input', (e) => {
        renderPromptsList(e.target.value);
      });
    }
  }

  function loadPromptFromLibrary(promptId) {
    const savedPrompts = JSON.parse(localStorage.getItem('thinkprompt_saved') || '[]');
    const prompt = savedPrompts.find(p => p.id == promptId);
    
    if (!prompt) {
      alert('Prompt not found.');
      return;
    }
    
    // Load prompt into workspace
    const promptDisplay = document.getElementById('promptDisplay');
    promptDisplay.innerHTML = `<pre style="white-space: pre-wrap; font-family: inherit; margin: 0;">${prompt.content}</pre>`;
    
    // Hide library and show workspace
    document.getElementById('librarySection').style.display = 'none';
    document.getElementById('workspaceSection').classList.add('show');
    
    // Scroll to workspace
    setTimeout(() => {
      document.getElementById('workspaceSection').scrollIntoView({ behavior: 'smooth' });
    }, 100);
    
    console.log('📖 Loaded prompt:', prompt.title);
  }

  function deleteSelectedPrompts() {
    const checkboxes = document.querySelectorAll('.prompt-checkbox:checked');
    const selectedIds = Array.from(checkboxes).map(cb => cb.dataset.promptId);
    
    if (selectedIds.length === 0) return;
    
    // Remove from localStorage
    const savedPrompts = JSON.parse(localStorage.getItem('thinkprompt_saved') || '[]');
    const remainingPrompts = savedPrompts.filter(p => !selectedIds.includes(p.id.toString()));
    localStorage.setItem('thinkprompt_saved', JSON.stringify(remainingPrompts));
    
    // Refresh list
    renderPromptsList();
  }

  function initializeLibraryButtons() {
    const deleteBtn = document.getElementById('deleteSelected');
    if (deleteBtn) {
      deleteBtn.addEventListener('click', deleteSelectedPrompts);
    }
  }

  // ===== LIBRARY FUNCTIONS - COMPLETE IMPLEMENTATION =====
  function openLibrary() {
    alert('Library feature removed - function hollowed');
  }









  // ===== STATE MANAGER =====
  const StateManager = {
    state: {
      currentCategory: null,
      selectedTemplate: null,
      currentStarterFilter: 'all'
    },
    
    setCategory(category) {
      this.state.currentCategory = category;
    },
    
    setTemplate(template) {
      this.state.selectedTemplate = template;
    },
    
    setStarterFilter(filter) {
      this.state.currentStarterFilter = filter;
    },
    
    getState() {
      return this.state;
    }
  };

  // ===== FORM MANAGER =====
  const FormManager = {
    getFormData() {
      return {
        goal: document.getElementById('goal').value.trim(),
        context: document.getElementById('context').value.trim(),
        tone: document.getElementById('tone').value.trim(),
        role: document.getElementById('role').value.trim(),
        format: document.getElementById('format').value.trim(),
        constraints: document.getElementById('constraints').value.trim(),
        examples: document.getElementById('examples').value.trim()
      };
    },
    
    clearAll() {
      const fields = ['goal', 'context', 'tone', 'role', 'format', 'constraints', 'examples'];
      fields.forEach(id => {
        const element = document.getElementById(id);
        if (element) element.value = '';
      });
    },
    
    showOptionalFields() {
      ['roleGroup', 'formatGroup', 'constraintsGroup', 'examplesGroup'].forEach(id => {
        const element = document.getElementById(id);
        if (element) element.classList.add('show');
      });
    }
  };

  // ===== QUALITY MANAGER =====
  const QualityManager = {
    assessQuality() {
      const coreFields = ['goal', 'context', 'tone'];
      const optionalFields = ['role', 'format', 'constraints', 'examples'];
      
      let coreCount = 0;
      let optionalCount = 0;

      // Count filled core fields
      coreFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field && field.value.trim()) {
          coreCount++;
        }
      });

      // Count filled optional fields (only if visible)
      optionalFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field && field.value.trim()) {
          const fieldGroup = field.closest('#roleGroup, #formatGroup, #constraintsGroup, #examplesGroup');
          
          if (fieldGroup) {
            const isVisible = window.getComputedStyle(fieldGroup).display !== 'none';
            if (isVisible) {
              optionalCount++;
            }
          } else {
            optionalCount++;
          }
        }
      });

      // 3-level status logic
      if (coreCount < 3) {
        return 'incomplete';
      } else if (coreCount === 3 && optionalCount < 2) {
        return 'ready';
      } else {
        return 'optimized';
      }
    },

    updateDisplay() {
      const quality = this.assessQuality();
      
      const messages = {
        none: "Select a template to begin building your prompt",
        incomplete: "Complete Goal + Context + Tone to create a working prompt",
        ready: "Ready to generate! Add Act As + Examples + Requirements for better results - the more detail, the better your prompt", 
        optimized: "Optimized prompt ready! Click here to generate"
      };

      this.updateStatusPanels(quality, messages[quality]);
    },

    updateStatusPanels(quality, message) {
      const statusConfigs = {
        none: { icon: '⚪', level: 'WAITING', className: 'status-none' },
        incomplete: { icon: '🔴', level: 'INCOMPLETE', className: 'status-incomplete' },
        ready: { icon: '🟡', level: 'READY TO GENERATE', className: 'status-ready' },
        optimized: { icon: '🟢', level: 'OPTIMIZED PROMPT', className: 'status-optimized' }
      };
      
      const config = statusConfigs[quality] || statusConfigs.none;
      
      // Update top panel
      const topPanel = document.getElementById('completionStatus');
      const icon = document.getElementById('statusIcon');
      const level = document.getElementById('statusLevel');
      const msgElement = document.getElementById('statusMessage');
      
      if (icon) icon.textContent = config.icon;
      if (level) {
        level.textContent = config.level;
        level.className = `status-level ${config.className}`;
      }
      if (msgElement) msgElement.textContent = message;
      
      // Update bottom panel
      const bottomPanel = document.getElementById('completionStatusBottom');
      const iconBottom = document.getElementById('statusIconBottom');
      const levelBottom = document.getElementById('statusLevelBottom');
      const msgElementBottom = document.getElementById('statusMessageBottom');
      
      if (iconBottom) iconBottom.textContent = config.icon;
      if (levelBottom) {
        levelBottom.textContent = config.level;
        levelBottom.className = `status-level ${config.className}`;
      }
      if (msgElementBottom) msgElementBottom.textContent = message;

      // SURGICAL FIX: Add clickable functionality for ready and optimized states
      if (quality === 'ready' || quality === 'optimized') {
        // Make both status panels clickable
        if (topPanel) {
          topPanel.classList.add('clickable');
          topPanel.style.cursor = 'pointer';
          topPanel.onclick = () => generatePrompt();
        }
        if (bottomPanel) {
          bottomPanel.classList.add('clickable');
          bottomPanel.style.cursor = 'pointer';
          bottomPanel.onclick = () => generatePrompt();
        }
      } else {
        // Remove clickable functionality
        if (topPanel) {
          topPanel.classList.remove('clickable');
          topPanel.style.cursor = 'default';
          topPanel.onclick = null;
        }
        if (bottomPanel) {
          bottomPanel.classList.remove('clickable');
          bottomPanel.style.cursor = 'default';
          bottomPanel.onclick = null;
        }
      }
    }
  };

  // ===== WORKSPACE FUNCTIONS - SURGICAL ADDITION =====
  function generatePrompt() {
    console.log('🚀 Generate Prompt clicked!');
    
    // Get form data
    const formData = FormManager.getFormData();
    const { selectedTemplate } = StateManager.getState();
    
    // Validate we have minimum requirements
    if (!formData.goal || !formData.context || !formData.tone) {
      alert('Please complete Goal, Context, and Tone fields before generating.');
      return;
    }
    
    // Build the prompt
    let generatedPrompt = '';
    
    // Add role from template or form
    if (selectedTemplate && selectedTemplate.role) {
      generatedPrompt += selectedTemplate.role + '\n\n';
    } else if (formData.role) {
      generatedPrompt += `Act as: ${formData.role}\n\n`;
    } else {
      generatedPrompt += 'You are a professional AI assistant.\n\n';
    }
    
    // Add task/goal
    generatedPrompt += `Your task: ${formData.goal}\n\n`;
    
    // Add context
    generatedPrompt += `Context: ${formData.context}\n\n`;
    
    // Add tone
    generatedPrompt += `Tone and style: ${formData.tone}\n\n`;
    
    // Add optional fields if provided
    if (formData.format) {
      generatedPrompt += `Output format: ${formData.format}\n\n`;
    }
    
    if (formData.constraints) {
      generatedPrompt += `Important requirements: ${formData.constraints}\n\n`;
    }
    
    if (formData.examples) {
      generatedPrompt += `Examples of desired output:\n${formData.examples}\n\n`;
    }
    
    // Add closing
    generatedPrompt += 'Please provide your response following all the above guidelines and requirements.';
    
    // Display in workspace
    const promptDisplay = document.getElementById('promptDisplay');
    promptDisplay.innerHTML = `<pre style="white-space: pre-wrap; font-family: inherit; margin: 0;">${generatedPrompt}</pre>`;
    
    // SURGICAL FIX: Close form sections when showing workspace
    document.getElementById('formSection').classList.remove('show');
    document.getElementById('completionStatus').classList.remove('show');
    document.getElementById('completionStatusBottom').classList.remove('show');
    document.getElementById('templatesSection').classList.remove('show');
    document.getElementById('librarySection').style.display = 'none';
    
    const saveModal = document.getElementById('saveModalOverlay');
    if (saveModal) saveModal.style.display = 'none';
    
    // Show workspace
    document.getElementById('workspaceSection').classList.add('show');
    
    // Scroll to workspace
    setTimeout(() => {
      document.getElementById('workspaceSection').scrollIntoView({ behavior: 'smooth' });
    }, 100);
    
    console.log('Generated prompt:', generatedPrompt);
  }

  // SURGICAL FIX: Updated copyPrompt function to filter out placeholder text
  function copyPrompt() {
    const promptDisplay = document.getElementById('promptDisplay');
    const text = (promptDisplay.textContent || promptDisplay.innerText).replace('No Prompt Generated YetComplete the form above and click generate to see your custom prompt here.', '').trim();
    
    if (text && text.trim()) {
      navigator.clipboard.writeText(text).then(() => {
        showCopySuccess('Copied to clipboard!');
      }).catch(() => {
        alert('Could not copy to clipboard. Please copy manually.');
      });
    } else {
      alert('No prompt to copy. Please generate a prompt first.');
    }
  }

  function editPrompt() {
    const promptDisplay = document.getElementById('promptDisplay');
    promptDisplay.focus();
    alert('You can now edit the prompt directly in the text area.');
  }

  function exportPrompt() {
    const promptDisplay = document.getElementById('promptDisplay');
    const text = promptDisplay.textContent || promptDisplay.innerText;
    
    if (text && text.trim()) {
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `thinkprompt-${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      alert('Prompt exported successfully!');
    } else {
      alert('No prompt to export. Please generate a prompt first.');
    }
  }

  // ===== CATEGORY-SPECIFIC GUIDANCE =====
  const categoryGuidance = {
    email: {
      goal: "Define specific email outcome: open rate %, response rate, meeting bookings, or sales conversions",
      context: "Include sender relationship, recipient pain points, timing considerations, and competitive landscape",
      tone: "Match recipient expectations: cold prospects need trust-building, warm leads can be more direct",
      role: "Specify email expertise: cold outreach specialist, nurture sequence expert, or sales closer",
      constraints: "Set email-specific limits: word count (cold emails <150 words), personalization scale, compliance requirements",
      examples: "Show successful email templates: subject lines that work, opening hooks, clear CTAs"
    },
    creative: {
      goal: "Define creative impact: brand awareness, engagement metrics, content virality, or conversion goals",
      context: "Include brand voice, target audience psychographics, platform algorithms, current trends",
      tone: "Match platform and audience: TikTok casual vs LinkedIn professional vs Instagram authentic",
      role: "Specify creative expertise: content strategist, copywriter, brand storyteller, or viral content creator",
      constraints: "Set creative boundaries: platform requirements, brand guidelines, content pillars, posting frequency",
      examples: "Show high-performing content: viral post formats, engagement-driving headlines, proven content structures"
    },
    video: {
      goal: "Define video success: view duration %, subscriber growth, click-through rates, or watch time optimization",
      context: "Include platform algorithm preferences, audience retention patterns, competitive analysis, trending topics",
      tone: "Match platform energy: YouTube educational vs TikTok viral vs LinkedIn thought leadership",
      role: "Specify video expertise: YouTube strategist, short-form creator, educational content producer, or viral specialist",
      constraints: "Set video-specific limits: duration (TikTok 15-60s, YouTube 8-12 min), hook timing (first 3-15 seconds critical)",
      examples: "Show proven video structures: hook-promise-payoff format, pattern interrupts, strong CTAs that drive action"
    },
    social: {
      goal: "Define social metrics: engagement rate %, follower growth, share velocity, or community building outcomes",
      context: "Include platform nuances, audience demographics, peak posting times, hashtag strategy, community guidelines",
      tone: "Platform-optimized voice: Twitter witty, Instagram authentic, LinkedIn professional, TikTok entertaining",
      role: "Specify social expertise: community manager, influencer strategist, brand voice specialist, or viral content creator",
      constraints: "Platform-specific rules: character limits, hashtag limits (Instagram 30, Twitter 2-3), posting frequency guidelines",
      examples: "Show viral content patterns: trending formats, engagement hooks, community-building techniques, shareable moments"
    },
    career: {
      goal: "Define career advancement: interview invitations, salary negotiations, promotion discussions, or network expansion",
      context: "Include industry standards, career level, company culture, hiring manager priorities, market conditions",
      tone: "Professional confidence: humble expert vs assertive leader vs collaborative team player",
      role: "Specify career expertise: resume strategist, interview coach, LinkedIn optimizer, or salary negotiator",
      constraints: "Career-specific requirements: ATS compatibility, industry keywords, quantified achievements, professional standards",
      examples: "Show successful formats: STAR method responses, achievement statements with metrics, industry-specific language"
    },
    business: {
      goal: "Define business impact: revenue growth %, operational efficiency, stakeholder buy-in, or competitive advantage",
      context: "Include market conditions, stakeholder priorities, budget constraints, timeline pressures, regulatory environment",
      tone: "Executive-level communication: data-driven confidence, strategic thinking, risk-aware optimism",
      role: "Specify business expertise: strategy consultant, market analyst, executive advisor, or transformation specialist",
      constraints: "Business requirements: budget parameters, timeline constraints, compliance needs, stakeholder approval levels",
      examples: "Show winning formats: executive summaries, ROI projections, risk mitigation strategies, implementation roadmaps"
    },
    custom: {
      goal: "Be specific about your desired outcome and success criteria",
      context: "Provide background: audience, industry, constraints, current situation",
      tone: "Define voice and personality that matches your audience",
      role: "Define what type of expert the AI should be",
      constraints: "Set clear boundaries and requirements",
      examples: "Show 2-3 concrete examples of exactly what you want"
    }
  };

  function updateCategoryHints(category) {
    const guidance = categoryGuidance[category] || categoryGuidance.custom;
    
    const hintElements = {
      goalHint: guidance.goal,
      contextHint: guidance.context,
      toneHint: guidance.tone,
      roleHint: guidance.role,
      constraintsHint: guidance.constraints,
      examplesHint: guidance.examples
    };
    
    Object.keys(hintElements).forEach(hintId => {
      const element = document.getElementById(hintId);
      if (element) {
        element.textContent = hintElements[hintId];
      }
    });
  }

  // ===== STARTER PROMPTS (ALL 27) =====
  const STARTER_PROMPTS = {
    email: [
      {
        id: 'starter_email_001',
        title: 'Cold Email That Gets 30%+ Response Rates',
        content: `You are an expert sales professional who writes personalized cold emails that get responses.

Your task: Write a cold email that gets prospects to respond and start a conversation.

Context: You're reaching out to [TARGET AUDIENCE] who struggle with [SPECIFIC PAIN POINT]. Research shows they're currently using [CURRENT SOLUTION] but facing challenges with [SPECIFIC CHALLENGE].

Tone and style: Professional but approachable, helpful colleague who understands their challenges

Important constraints: Keep under 150 words, include a clear call-to-action, personalize with specific details about their business

Examples of desired output:
Subject: Quick question about [SPECIFIC CHALLENGE] at [COMPANY]
Hi [NAME], Noticed [SPECIFIC OBSERVATION]. Quick question about [CHALLENGE] - have 30 seconds for a brief response? [CTA]

Please provide your response following all the above guidelines and requirements.`,
        category: 'email',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_email_002',
        title: 'Follow-up Email That Converts',
        content: `You are a professional email marketing strategist who creates follow-up sequences that convert leads into customers.

Your task: Write a follow-up email that nurtures the relationship and drives the prospect to take the next step.

Context: This prospect has already engaged with you (opened email, visited website, downloaded content, or attended webinar). They know who you are but haven't committed yet.

Tone and style: Confident but helpful, you've earned the right to be more direct while still providing value

Important constraints: Reference the previous interaction, provide additional value, include one clear call-to-action

Examples of desired output:
"Hi [NAME], saw you downloaded our [RESOURCE] - here's the one insight most people miss..."
"Since you attended [WEBINAR], wanted to share the advanced strategy we couldn't cover..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'email',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_email_003',
        title: 'Sales Closing Email That Seals Deals',
        content: `You are a sales closing expert who writes emails that overcome objections and close deals.

Your task: Write a closing email that addresses concerns and motivates prospects to make a buying decision.

Context: Prospect has shown strong interest but hasn't committed. Common objections include [PRICE/TIMING/AUTHORITY]. Decision timeline is [TIMEFRAME]. Competition includes [ALTERNATIVES].

Tone and style: Confident and consultative, trusted advisor who understands their business needs

Important constraints: Address specific objections, create urgency without pressure, include risk reversal, clear next steps

Examples of desired output:
"Hi [NAME], understand you need to [CONSIDER BUDGET/TIMING]. Here's how [SOLUTION] pays for itself in [TIMEFRAME]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'email',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_email_004',
        title: 'Re-engagement Email That Wins Back Customers',
        content: `You are a customer retention specialist who creates emails that win back inactive customers.

Your task: Write a re-engagement email that brings inactive customers back to your product or service.

Context: Customer hasn't engaged in [TIMEFRAME]. They previously [USED PRODUCT/PURCHASED/ENGAGED]. Likely reasons for leaving include [PAIN POINTS]. New features/improvements include [UPDATES].

Tone and style: Warm and understanding, friend who genuinely wants to help rather than pushy salesperson

Important constraints: Acknowledge the absence, highlight improvements, offer incentive, make return easy

Examples of desired output:
"Hi [NAME], noticed you haven't [SPECIFIC ACTION] in a while. We've made some changes you might find interesting..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'email',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_email_005',
        title: 'Partnership Proposal Email',
        content: `You are a business development expert who creates partnership proposals that generate mutual opportunities.

Your task: Write a partnership proposal email that presents a compelling collaboration opportunity.

Context: Potential partner has [COMPLEMENTARY BUSINESS/AUDIENCE/EXPERTISE]. Mutual benefits include [SHARED GOALS]. Proposed collaboration is [PARTNERSHIP TYPE]. Success metrics would be [MEASURABLE OUTCOMES].

Tone and style: Professional and strategic, equal partner proposing mutual value rather than vendor seeking favor

Important constraints: Focus on mutual benefits, provide specific collaboration ideas, suggest low-risk starting point

Examples of desired output:
        "Hi [NAME], noticed your work with [AUDIENCE]. Believe there's an opportunity for [MUTUAL BENEFIT]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'email',
        rating: 4,
        author: 'ThinkPrompt Team'
      }
    ],
    creative: [
      {
        id: 'starter_creative_001',
        title: 'Blog Post That Ranks #1 on Google',
        content: `You are a content marketing expert who creates blog posts that rank well in search and engage readers.

Your task: Write a comprehensive blog post that provides exceptional value while optimizing for search engines.

Context: Target keyword is [KEYWORD] with search intent [INFORMATIONAL/COMMERCIAL/NAVIGATIONAL]. Audience expertise level is [BEGINNER/INTERMEDIATE/ADVANCED]. Competition analysis shows gaps in [SPECIFIC AREAS].

Tone and style: Authoritative but accessible, knowledgeable guide sharing expertise rather than academic lecture

Important constraints: 1500-3000 words, include actionable steps, use headers for scannability, include examples, natural keyword integration, clear call-to-action

Examples of desired output:
"Most people think [COMMON BELIEF] about [TOPIC]. After analyzing [DATA], here's what actually works..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'creative',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_creative_002',
        title: 'Product Copy That Converts Browsers to Buyers',
        content: `You are a conversion copywriter who writes product descriptions and sales copy that drives purchases.

Your task: Write persuasive product copy that highlights benefits and overcomes buying objections.

Context: Product is [PRODUCT TYPE] for [TARGET CUSTOMER]. Price point is [PRICE RANGE]. Main benefits are [KEY BENEFITS]. Common objections include [CONCERNS]. Competitors offer [ALTERNATIVES].

Tone and style: Enthusiastic but credible, excited customer sharing discovery rather than pushy salesperson

Important constraints: Focus on benefits over features, address objections, include social proof, clear call-to-action

Examples of desired output:
"Imagine [DESIRED OUTCOME] in just [TIMEFRAME]. Here's how [PRODUCT] makes it possible..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'creative',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_creative_003',
        title: 'Story That Captivates and Converts',
        content: `You are a master storyteller who creates narratives that engage emotions and drive action.

Your task: Write a compelling story that connects with your audience and motivates them toward a specific outcome.

Context: Story purpose is [BRAND/LESSON/ENTERTAINMENT]. Target audience is [DEMOGRAPHICS/PSYCHOGRAPHICS]. Key message is [CORE THEME]. Desired action is [GOAL].

Tone and style: Engaging and authentic, skilled storyteller who understands human psychology

Important constraints: Clear story arc, emotional connection, relevant to audience, natural integration of message

Examples of desired output:
"Sarah stared at her inbox. 247 unread emails. Sound familiar? Here's how she went from overwhelmed to organized in just one week..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'creative',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_creative_004',
        title: 'Ad Campaign That Stops the Scroll',
        content: `You are an advertising creative director who develops campaigns that capture attention and drive measurable results.

Your task: Create advertising copy that breaks through noise and compels target audience to take action.

Context: Advertising on [PLATFORM]. Target audience is [SPECIFIC DEMOGRAPHICS]. Campaign goal is [AWARENESS/CONVERSION/RETENTION]. Budget is [RANGE]. Competition includes [COMPETITORS].

Tone and style: Bold and attention-grabbing, creative that understands platform behavior and audience psychology

Important constraints: Platform-specific format, thumb-stopping creative, clear value proposition, strong call-to-action

Examples of desired output:
"[SHOCKING STATISTIC] that will change how you think about [TOPIC]..." or "The [SOLUTION] that [COMPETITOR] doesn't want you to know about..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'creative',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_creative_005',
        title: 'Newsletter That People Actually Read',
        content: `You are a newsletter strategist who creates content that subscribers eagerly anticipate and engage with.

Your task: Write newsletter content that provides consistent value and builds long-term subscriber relationships.

Context: Newsletter frequency is [WEEKLY/MONTHLY]. Audience is [PROFESSIONAL/CONSUMER]. Topics include [SUBJECT AREAS]. Open rates currently [BENCHMARK]. Goal is [ENGAGEMENT/GROWTH/REVENUE].

Tone and style: Conversational and valuable, trusted friend sharing interesting discoveries rather than corporate announcement

Important constraints: Scannable format, mix of content types, clear value in each section, engaging subject line

Examples of desired output:
"3 things I learned this week that changed my perspective on [TOPIC]..." or "The tool everyone's talking about (and why I'm not convinced)..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'creative',
        rating: 4,
        author: 'ThinkPrompt Team'
      }
    ],
    video: [
      {
        id: 'starter_video_001',
        title: 'YouTube Script That Keeps 80%+ Viewers',
        content: `You are an experienced YouTube content creator who understands how to structure videos for maximum engagement and subscriber growth.

Your task: Write a YouTube video script that captures attention immediately and maintains engagement throughout.

Context: Video topic is [TOPIC] targeting [AUDIENCE]. Video length is [DURATION]. Audience knowledge level is [BEGINNER/INTERMEDIATE/ADVANCED]. Goal is [EDUCATE/ENTERTAIN/CONVERT].

Tone and style: [HIGH-ENERGY/CALM/CONVERSATIONAL] and engaging, authentic personality that keeps viewers watching while delivering value

Important constraints: Hook in first 15 seconds, clear value proposition, include pattern interrupts, call-to-action for subscribe/like, maintain pacing throughout

Examples of desired output:
"In the next 8 minutes, I'll show you the [TECHNIQUE] that [OUTCOME] - but first, this one mistake kills most people's results..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'video',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_video_002',
        title: 'TikTok Script That Goes Viral',
        content: `You are a TikTok content creator who understands viral trends and creates engaging short-form content.

Your task: Write a TikTok video script that stops scroll and drives engagement.

Context: Using [TRENDING SOUND/FORMAT]. Target audience is [DEMOGRAPHICS]. Content angle is [EDUCATIONAL/ENTERTAINING/BEHIND-SCENES]. Current trending topics include [TRENDS].

Tone and style: Authentic and entertaining, friend sharing something cool rather than polished advertisement

Important constraints: Hook in first 3 seconds, 15-60 seconds total, include trending elements, text overlay opportunities, shareable moment

Examples of desired output:
"POV: You just learned [SURPRISING FACT] and now you can't unsee it everywhere... *shows examples*"

Please provide your response following all the above guidelines and requirements.`,
        category: 'video',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_video_003',
        title: 'Tutorial Video That Actually Teaches',
        content: `You are an educational content creator who breaks down complex topics into digestible, actionable lessons.

Your task: Create a tutorial video script that teaches a skill clearly and enables viewers to succeed.

Context: Teaching [SKILL/TOPIC] to [AUDIENCE LEVEL]. Common struggles include [PAIN POINTS]. Available tools/resources are [REQUIREMENTS]. Expected outcome is [GOAL].

Tone and style: Patient and encouraging, helpful teacher who wants students to succeed rather than expert showing off knowledge

Important constraints: Clear step-by-step structure, anticipate common mistakes, provide checkpoints, include troubleshooting, actionable outcome

Examples of desired output:
"By the end of this video, you'll be able to [SPECIFIC OUTCOME]. We'll start with [STEP 1] - and don't worry if you get stuck, I'll show you exactly how to fix the most common issue..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'video',
        rating: 5,
        author: 'ThinkPrompt Team'
      }
    ],
    social: [
      {
        id: 'starter_social_001',
        title: 'LinkedIn Post That Builds Authority',
        content: `You are a LinkedIn content strategist who helps professionals build their personal brand and generate business opportunities.

Your task: Write a LinkedIn post that demonstrates expertise while encouraging professional engagement.

Context: You're a [YOUR PROFESSION] sharing insights about [INDUSTRY TOPIC]. Your network includes [AUDIENCE TYPES]. Current industry challenges include [PAIN POINTS]. Your unique perspective is [ANGLE].

Tone and style: Professional but personable, industry expert sharing valuable insights rather than formal corporate announcement

Important constraints: Professional value, personal story elements, industry relevance, engagement hook, clear point of view, call for discussion

Examples of desired output:
"After 10 years in [INDUSTRY], I've noticed most companies make this one critical mistake with [TOPIC]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'social',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_social_002',
        title: 'Instagram Post That Drives Engagement',
        content: `You are an Instagram content creator who builds engaged communities and drives meaningful interactions.

Your task: Create Instagram content that stops the scroll and encourages authentic engagement.

Context: Account focuses on [NICHE/TOPIC]. Audience is [DEMOGRAPHICS]. Current engagement rate is [BENCHMARK]. Content pillars include [THEMES]. Platform trends include [CURRENT TRENDS].

Tone and style: Authentic and relatable, friend sharing valuable experiences rather than polished influencer

Important constraints: Visual storytelling, engaging caption, relevant hashtags, call for engagement, authentic voice

Examples of desired output:
"POV: You finally figure out [COMMON STRUGGLE] and everything clicks... Here's what I wish I knew sooner 👇"

Please provide your response following all the above guidelines and requirements.`,
        category: 'social',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_social_003',
        title: 'Twitter Thread That Goes Viral',
        content: `You are a Twitter content strategist who creates threads that educate, engage, and expand reach.

Your task: Write a Twitter thread that provides value and encourages retweets and follows.

Context: Thread topic is [SUBJECT]. Target audience includes [AUDIENCE TYPES]. Thread length should be [TWEET COUNT]. Goal is [EDUCATION/ENGAGEMENT/GROWTH]. Current trends include [RELEVANT TOPICS].

Tone and style: Informative and engaging, knowledgeable person sharing valuable insights in digestible format

Important constraints: Hook in first tweet, valuable information, logical flow, retweet-worthy insights, engagement prompts

Examples of desired output:
"🧵 Thread: The [NUMBER] mistakes that kill [OUTCOME] (and how to avoid them)
1/ Most people think [MISCONCEPTION]. Here's what actually happens..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'social',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_social_004',
        title: 'TikTok Video Script That Gets Views',
        content: `You are a TikTok content creator who understands viral mechanics and creates engaging short-form videos.

Your task: Write a TikTok video script that captures attention and drives engagement.

Context: Video topic is [SUBJECT]. Target audience is [AGE/INTERESTS]. Video format is [EDUCATIONAL/ENTERTAINMENT/BEHIND-SCENES]. Trending sounds include [AUDIO OPTIONS]. Goal is [VIEWS/FOLLOWS/ENGAGEMENT].

Tone and style: Energetic and authentic, friend sharing something cool rather than professional presenter

Important constraints: Hook in first 3 seconds, maintain attention throughout, include trending elements, clear value or entertainment

Examples of desired output:
"Wait... did you know [SURPRISING FACT]? I had no idea until [DISCOVERY MOMENT] 👀 *shows evidence*"

Please provide your response following all the above guidelines and requirements.`,
        category: 'social',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_social_005',
        title: 'Facebook Ad That Converts Cold Traffic',
        content: `You are a Facebook advertising specialist who creates ads that turn cold audiences into customers.

Your task: Write Facebook ad copy that captures attention and drives conversions from people unfamiliar with your brand.

Context: Product/service is [OFFERING]. Target audience is [DEMOGRAPHICS/INTERESTS]. Ad objective is [CONVERSION GOAL]. Budget is [DAILY/CAMPAIGN]. Competition includes [COMPETITORS].

Tone and style: Conversational and compelling, helpful friend recommending solution rather than obvious advertisement

Important constraints: Attention-grabbing opener, clear benefit, social proof, urgency/scarcity, strong call-to-action

Examples of desired output:
"[RELATABLE PROBLEM]? Here's the [SOLUTION] that [SOCIAL PROOF] are using to [DESIRED OUTCOME]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'social',
        rating: 5,
        author: 'ThinkPrompt Team'
      }
    ],
    career: [
      {
        id: 'starter_career_001',
        title: 'Resume Summary That Gets Interviews',
        content: `You are a career coach and resume expert who helps professionals create summaries that get interviews.

Your task: Write a professional summary that makes recruiters want to learn more about this candidate.

Context: Target role is [SPECIFIC POSITION] in [INDUSTRY]. Candidate has [X] years experience in [FIELD]. Key achievements include [ACCOMPLISHMENTS]. Career level is [ENTRY/MID/SENIOR/EXECUTIVE].

Tone and style: Confident and professional, accomplished professional highlighting achievements rather than modest person downplaying skills

Important constraints: 3-4 sentences, quantified achievements, relevant keywords, value proposition clear, ATS-friendly language

Examples of desired output:
"Marketing professional with 5+ years driving [X]% revenue growth through data-driven campaigns. Led [ACHIEVEMENT] resulting in [OUTCOME]. Expertise in [SKILLS] with proven track record of [RESULTS]."

Please provide your response following all the above guidelines and requirements.`,
        category: 'career',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_career_002',
        title: 'Cover Letter That Opens Doors',
        content: `You are a career strategist who writes cover letters that get candidates noticed and invited for interviews.

Your task: Write a personalized cover letter that connects candidate experience to specific job requirements.

Context: Job posting emphasizes [KEY REQUIREMENTS]. Company culture values [COMPANY VALUES]. Candidate's relevant experience includes [BACKGROUND]. Career transition involves [CHANGE TYPE]. Hiring manager likely cares about [PRIORITIES].

Tone and style: Professional yet personable, qualified candidate who understands the role and company

Important constraints: Address hiring manager by name, reference specific job requirements, highlight relevant achievements, show company research

Examples of desired output:
"Dear [HIRING MANAGER], Your recent posting for [POSITION] caught my attention because of [SPECIFIC DETAIL]. In my [X] years at [COMPANY], I [RELEVANT ACHIEVEMENT]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'career',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_career_003',
        title: 'LinkedIn Profile That Attracts Recruiters',
        content: `You are a personal branding expert who optimizes LinkedIn profiles to attract opportunities and build professional networks.

Your task: Create LinkedIn profile content that improves visibility and attracts the right professional opportunities.

Context: Professional is [CURRENT ROLE] seeking [TARGET OPPORTUNITIES]. Industry is [SECTOR]. Career goals include [OBJECTIVES]. Key skills are [COMPETENCIES]. Target audience includes [RECRUITERS/CLIENTS/PEERS].

Tone and style: Professional and approachable, accomplished expert who is confident but accessible

Important constraints: Keyword optimization, achievement focus, industry relevance, clear value proposition, engaging personality

Examples of desired output:
"[TITLE] helping [TARGET AUDIENCE] achieve [OUTCOME] through [METHODOLOGY]. [X]+ years transforming [SPECIFIC AREA] with proven results in [ACHIEVEMENTS]."

Please provide your response following all the above guidelines and requirements.`,
        category: 'career',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_career_004',
        title: 'Interview Answers That Win Job Offers',
        content: `You are an interview coach who helps candidates prepare compelling responses that demonstrate qualifications and cultural fit.

Your task: Create structured interview responses using proven frameworks that showcase qualifications effectively.

Context: Interview is for [POSITION] at [COMPANY TYPE]. Key competencies being assessed include [SKILLS/QUALITIES]. Common questions include [QUESTION TYPES]. Candidate's background includes [EXPERIENCE]. Interview format is [STYLE].

Tone and style: Confident and articulate, qualified candidate who can clearly communicate value while showing authentic personality

Important constraints: Use STAR method (Situation, Task, Action, Result), provide specific examples, quantify achievements, show growth mindset, demonstrate cultural fit

Examples of desired output:
"When asked about leadership: 'In my role as [POSITION], I faced [SITUATION]. My task was to [RESPONSIBILITY]. I took action by [SPECIFIC STEPS] which resulted in [QUANTIFIED OUTCOME]. This taught me [LEARNING]...'"

Please provide your response following all the above guidelines and requirements.`,
        category: 'career',
        rating: 4,
        author: 'ThinkPrompt Team'
      }
    ],
    business: [
      {
        id: 'starter_business_001',
        title: 'Business Plan That Secures Funding',
        content: `You are a business strategy consultant who helps entrepreneurs create business plans that secure funding and partnerships.

Your task: Write an executive summary that makes investors want to learn more about your business opportunity.

Context: Business is [BUSINESS TYPE] solving [PROBLEM] for [TARGET MARKET]. Market size is [TAM/SAM]. Business model is [REVENUE MODEL]. Competitive advantage is [DIFFERENTIATOR]. Funding need is [AMOUNT] for [PURPOSE].

Tone and style: Professional and confident, experienced entrepreneur with proven opportunity rather than hopeful startup with untested idea

Important constraints: 1-2 pages maximum, clear problem/solution fit, market opportunity size, competitive advantage, financial projections, funding use, team credibility

Examples of desired output:
"[COMPANY] addresses the $[X]B market opportunity in [SECTOR] by [SOLUTION]. Our proven model generates [REVENUE] with [MARGIN]% margins. Seeking $[AMOUNT] to [OBJECTIVE]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'business',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_business_002',
        title: 'Market Research Report That Guides Strategy',
        content: `You are a market research analyst who provides insights that help businesses make informed strategic decisions.

Your task: Create a comprehensive market analysis that informs strategic business decisions with actionable insights.

Context: Research focuses on [INDUSTRY/MARKET]. Key questions include [RESEARCH OBJECTIVES]. Available data sources are [DATA TYPES]. Target audience for report is [EXECUTIVES/MANAGERS/INVESTORS]. Decision timeline is [TIMEFRAME].

Tone and style: Analytical and objective, expert researcher presenting data-driven insights rather than opinion-based recommendations

Important constraints: Executive summary first, data-driven conclusions, visual data presentation, actionable recommendations, risk assessment, competitive landscape

Examples of desired output:
"Market analysis reveals [KEY FINDING] with [X]% growth projected over [TIMEFRAME]. Primary drivers include [FACTORS]. Recommended strategy: [APPROACH]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'business',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_business_003',
        title: 'Proposal That Wins New Business',
        content: `You are a business development specialist who writes proposals that win contracts and close deals.

Your task: Create a compelling business proposal that demonstrates value and wins the contract.

Context: Client needs [SPECIFIC REQUIREMENTS]. Project scope includes [DELIVERABLES]. Timeline is [DURATION]. Budget range is [AMOUNT]. Competition includes [COMPETITORS]. Client priorities are [KEY CONCERNS].

Tone and style: Professional and solution-focused, trusted partner who understands client needs rather than vendor pushing services

Important constraints: Address client pain points, demonstrate understanding, clear deliverables, realistic timeline, competitive pricing, proof of capability

Examples of desired output:
"Based on your need for [REQUIREMENT], we propose [SOLUTION] that delivers [OUTCOME] within [TIMELINE]. Our approach includes [METHODOLOGY]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'business',
        rating: 5,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_business_004',
        title: 'Strategic Plan That Drives Growth',
        content: `You are a strategic planning consultant who helps organizations develop clear roadmaps for sustainable growth and competitive advantage.

Your task: Create a strategic plan that provides clear direction and actionable steps for organizational growth.

Context: Organization is [COMPANY TYPE] in [INDUSTRY]. Current challenges include [OBSTACLES]. Growth goals are [OBJECTIVES]. Timeline is [DURATION]. Available resources include [BUDGET/TEAM]. Market conditions include [ENVIRONMENT].

Tone and style: Strategic and forward-thinking, experienced advisor who balances ambition with pragmatism

Important constraints: Clear vision statement, SWOT analysis, specific goals with metrics, resource allocation, risk mitigation, implementation timeline

Examples of desired output:
"Strategic vision: [VISION STATEMENT]. Based on market analysis, we recommend focusing on [PRIORITIES] to achieve [X]% growth within [TIMEFRAME] through [STRATEGIES]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'business',
        rating: 4,
        author: 'ThinkPrompt Team'
      },
      {
        id: 'starter_business_005',
        title: 'Pitch Deck That Gets Investor Meetings',
        content: `You are a startup advisor who helps entrepreneurs create pitch decks that capture investor attention and secure funding meetings.

Your task: Write compelling pitch deck content that tells a persuasive story and motivates investors to learn more.

Context: Startup is [BUSINESS TYPE] in [SECTOR]. Problem being solved is [PAIN POINT]. Solution is [PRODUCT/SERVICE]. Target market is [AUDIENCE]. Traction includes [METRICS]. Funding round is [SERIES/AMOUNT].

Tone and style: Compelling and confident, visionary entrepreneur who understands market opportunity and can execute successfully

Important constraints: 10-12 slide structure, compelling problem/solution narrative, market size validation, business model clarity, team credibility, clear ask

Examples of desired output:
"Problem: [X MILLION] people struggle with [PAIN POINT], costing [INDUSTRY] $[AMOUNT] annually. Our solution: [PRODUCT] that [UNIQUE VALUE]. Early traction: [METRICS]..."

Please provide your response following all the above guidelines and requirements.`,
        category: 'business',
        rating: 5,
        author: 'ThinkPrompt Team'
      }
    ]
  };

  // ===== CONTENT MANAGER =====
  const ContentManager = {
    updateContentSection(content) {
      document.getElementById('contentSection').innerHTML = content;
    },
    
    renderStarterPrompts(filter) {
      let allPrompts = [];
      
      Object.values(STARTER_PROMPTS).forEach(categoryPrompts => {
        allPrompts = allPrompts.concat(categoryPrompts);
      });
      
      const filteredPrompts = filter === 'all' 
        ? allPrompts
        : allPrompts.filter(prompt => prompt.category === filter);
      
      if (filteredPrompts.length === 0) {
        return `
          <div class="templates-header">
            <h3 class="templates-title">NO PROMPTS FOUND</h3>
          </div>
          <div style="padding: 20px;">
            <div class="welcome-state">
              <div class="welcome-icon">
                <svg fill="none" height="48" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="48"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>
              </div>
              <h3 class="welcome-title">No prompts found</h3>
              <p class="welcome-text">Try a different category or check out the templates above</p>
            </div>
          </div>
        `;
      }
      
      const categoryNames = {
        all: 'ALL READY-TO-USE PROMPTS',
        email: 'EMAIL PROMPTS',
        creative: 'CREATIVE PROMPTS', 
        video: 'VIDEO PROMPTS',
        social: 'SOCIAL MEDIA PROMPTS',
        career: 'CAREER PROMPTS',
        business: 'BUSINESS PROMPTS'
      };
      
      return `
        <div class="templates-header">
          <h3 class="templates-title">${categoryNames[filter] || 'PROMPTS'}</h3>
        </div>
        <div style="padding: 20px;">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">
            ${filteredPrompts.map(prompt => `
              <div class="starter-prompt-card" onclick="usePrompt('${prompt.id}')">
                <div style="font-weight: 600; color: #1e293b;">${prompt.title}</div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }
  };

  // ===== GLOBAL FUNCTIONS =====
  function switchCategory(category) {
    try {
      console.log('Template category selected:', category);
      
      StateManager.setCategory(category);
      
      // Update category-specific hints
      updateCategoryHints(category);
      
      // Clear content section when showing templates for mutual exclusion
      ContentManager.updateContentSection('');
      
      // Hide library section, modal, and workspace
      const librarySection = document.getElementById('librarySection');
      const saveModal = document.getElementById('saveModalOverlay');
      const workspaceSection = document.getElementById('workspaceSection');
      if (librarySection) librarySection.style.display = 'none';
      if (saveModal) saveModal.style.display = 'none';
      if (workspaceSection) workspaceSection.classList.remove('show');
      
      const templatesSection = document.getElementById('templatesSection');
      if (!templatesSection) {
        console.error('Templates section not found');
        return;
      }
      
      const categoryNames = {
        email: 'EMAIL TEMPLATES',
        creative: 'CREATIVE TEMPLATES', 
        video: 'VIDEO TEMPLATES',
        social: 'SOCIAL MEDIA TEMPLATES',
        career: 'CAREER TEMPLATES',
        business: 'BUSINESS TEMPLATES',
        custom: 'CUSTOM TEMPLATES'
      };
      
      if (category === 'custom') {
        templatesSection.innerHTML = `
          <div class="templates-header">
            <h3 class="templates-title">CUSTOM TEMPLATES</h3>
          </div>
          <div class="templates-content">
            <div class="templates-grid">
              <div class="template-card selected" onclick="selectTemplate('custom')" data-template="custom">
                <div class="template-name">Build From Scratch</div>
                <div class="template-desc">Build a completely custom prompt with full control over every element.</div>
              </div>
            </div>
          </div>
        `;
        
        // Show form immediately for custom
        FormManager.showOptionalFields();
        showFormSection();
        
        // Set custom template state
        StateManager.setTemplate({ 
          name: 'Custom Template', 
          description: 'Build from scratch', 
          role: 'You are a professional AI assistant.' 
        });
        
      } else {
        const categoryTemplates = templateData[category] || {};
        const templateKeys = Object.keys(categoryTemplates);
        
        if (templateKeys.length === 0) {
          console.warn('No templates found for category:', category);
        }
        
        templatesSection.innerHTML = `
          <div class="templates-header">
            <h3 class="templates-title">${categoryNames[category] || 'TEMPLATES'}</h3>
          </div>
          <div class="templates-content">
            <div class="templates-grid">
              ${templateKeys.map(templateKey => {
                const template = categoryTemplates[templateKey];
                if (!template) {
                  console.warn('Template not found:', templateKey);
                  return '';
                }
                return `
                  <div class="template-card" onclick="selectTemplate('${templateKey}')" data-template="${templateKey}">
                    <div class="template-name">${template.name || 'Unnamed Template'}</div>
                    <div class="template-desc">${template.description || 'No description available'}</div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        `;
      }
      
      templatesSection.classList.add('show');
      
      // Update active tab
      document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
      const activeTab = document.querySelector(`[data-category="${category}"]`);
      if (activeTab) {
        activeTab.classList.add('active');
      }
      
      QualityManager.updateDisplay();
      
    } catch (error) {
      console.error('Error in switchCategory:', error);
      alert('An error occurred while loading templates. Please refresh the page and try again.');
    }
  }

  function selectTemplate(templateKey) {
    console.log('Sprint 2: Template selected:', templateKey);
    
    // SURGICAL FIX: Close workspace when selecting new template for clean start
    document.getElementById('workspaceSection').classList.remove('show');
    
    const { currentCategory } = StateManager.getState();
    let selectedTemplate = null;
    
    if (currentCategory === 'custom') {
      selectedTemplate = { 
        name: 'Custom Template', 
        description: 'Build from scratch', 
        role: 'You are a professional AI assistant.' 
      };
    } else if (currentCategory && templateData[currentCategory]) {
      selectedTemplate = templateData[currentCategory][templateKey];
    }
    
    if (selectedTemplate) {
      StateManager.setTemplate(selectedTemplate);
      
      document.querySelectorAll('.template-card').forEach(card => {
        card.classList.remove('selected');
      });
      
      const selectedCard = document.querySelector(`[data-template="${templateKey}"]`);
      if (selectedCard) {
        selectedCard.classList.add('selected');
      }
      
      // Show form system
      FormManager.showOptionalFields();
      showFormSection();
      
      // Hide templates section when template is selected
      document.getElementById('templatesSection').classList.remove('show');
      
      QualityManager.updateDisplay();
    }
  }

  function showFormSection() {
    document.getElementById('formSection').classList.add('show');
    document.getElementById('completionStatus').classList.add('show');
    document.getElementById('completionStatusBottom').classList.add('show');
    
    setTimeout(() => {
      document.getElementById('formSection').scrollIntoView({ behavior: 'smooth' });
    }, 100);
  }

  function switchStarter(filter) {
    console.log('Starter prompts filter:', filter);
    
    StateManager.setStarterFilter(filter);
    
    // Hide templates section when starter prompts are browsed
    document.getElementById('templatesSection').classList.remove('show');
    
    // Hide form section when browsing starter prompts
    document.getElementById('formSection').classList.remove('show');
    document.getElementById('completionStatus').classList.remove('show');
    document.getElementById('completionStatusBottom').classList.remove('show');
    
    // Hide library section, modal, and workspace
    document.getElementById('librarySection').style.display = 'none';
    document.getElementById('workspaceSection').classList.remove('show');
    
    const saveModal = document.getElementById('saveModalOverlay');
    if (saveModal) saveModal.style.display = 'none';
    
    const content = ContentManager.renderStarterPrompts(filter);
    ContentManager.updateContentSection(content);
    
    document.querySelectorAll('.starter-tab').forEach(t => t.classList.remove('active'));
    document.querySelector(`[data-category="${filter}"][data-mode="starter"]`).classList.add('active');
  }

  // ===== STARTER PROMPT FUNCTIONS - MOVED TO GLOBAL SCOPE =====
  function usePrompt(promptId) {
    console.log('Use prompt:', promptId);
    
    // Find the prompt by ID
    let foundPrompt = null;
    Object.values(STARTER_PROMPTS).forEach(categoryPrompts => {
      const prompt = categoryPrompts.find(p => p.id === promptId);
      if (prompt) foundPrompt = prompt;
    });
    
    if (foundPrompt) {
      console.log('Found prompt:', foundPrompt.title);
      
      // SURGICAL FIX: Use same display method as generatePrompt() function
      const promptDisplay = document.getElementById('promptDisplay');
      promptDisplay.innerHTML = `<pre style="white-space: pre-wrap; font-family: inherit; margin: 0;">${foundPrompt.content}</pre>`;
      
      console.log('Prompt loaded into workspace');
      
      // Hide other sections
      document.getElementById('formSection').classList.remove('show');
      document.getElementById('completionStatus').classList.remove('show');
      document.getElementById('completionStatusBottom').classList.remove('show');
      document.getElementById('templatesSection').classList.remove('show');
      document.getElementById('librarySection').style.display = 'none';
      
      const saveModal = document.getElementById('saveModalOverlay');
      if (saveModal) saveModal.style.display = 'none';
      
      // Hide starter prompts browsing section
      ContentManager.updateContentSection('');
      
      // Show workspace
      document.getElementById('workspaceSection').classList.add('show');
      
      // Scroll to workspace
      setTimeout(() => {
        document.getElementById('workspaceSection').scrollIntoView({ behavior: 'smooth' });
      }, 100);
    } else {
      console.error('Prompt not found:', promptId);
      alert('Prompt not found. Please try again.');
    }
  }

  function initializeFormListeners() {
    const fields = ['goal', 'context', 'tone', 'role', 'format', 'constraints', 'examples'];
    
    fields.forEach(fieldId => {
      const field = document.getElementById(fieldId);
      if (field) {
        field.addEventListener('input', () => {
          QualityManager.updateDisplay();
        });
        field.addEventListener('change', () => {
          QualityManager.updateDisplay();
        });
      }
    });
  }

  function initializeCategoryTabs() {
    document.querySelectorAll('.category-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        const category = tab.dataset.category;
        switchCategory(category);
      });
    });
  }

  function initializeStarterTabs() {
    document.querySelectorAll('.starter-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        const filter = tab.dataset.category;
        switchStarter(filter);
      });
    });
  }

  // ===== TEMPLATE DATA (COMPLETE - 36 TEMPLATES) =====
  const templateData = {
    email: {
      cold_outreach: {
        name: "Cold Outreach Email",
        description: "Personalized cold emails that get responses and start meaningful business conversations",
        role: "You are an expert cold email strategist who helps professionals create personalized outreach that gets responses."
      },
      follow_up_sequence: {
        name: "Follow-up Email Sequence", 
        description: "Multi-touch email sequences that nurture leads and drive conversions over time",
        role: "You are a professional email marketing strategist who specializes in creating follow-up sequences that convert leads into customers."
      },
      meeting_request: {
        name: "Meeting Request Email",
        description: "Professional meeting requests with clear agendas and scheduling options", 
        role: "You are a professional meeting coordinator who creates clear, respectful meeting requests that make it easy for people to say yes."
      },
      sales_pitch: {
        name: "Sales Pitch Email",
        description: "Persuasive sales emails that convert prospects into customers",
        role: "You are a sales conversion expert who writes compelling pitch emails that drive revenue."
      },
      newsletter: {
        name: "Newsletter Content",
        description: "Engaging newsletter content that builds audience and drives action",
        role: "You are a newsletter specialist who creates content that subscribers eagerly open and share."
      },
      customer_support: {
        name: "Customer Support Email", 
        description: "Professional support emails that resolve issues and maintain relationships",
        role: "You are a customer service expert who turns support interactions into positive experiences."
      }
    },
    creative: {
      story_starter: {
        name: "Story Starter",
        description: "Compelling story openings that hook readers and establish engaging narratives",
        role: "You are a master storyteller who creates compelling opening scenes that immediately hook readers and establish engaging narratives."
      },
      character_development: {
        name: "Character Development", 
        description: "Rich character profiles with depth, motivation, and growth potential",
        role: "You are a character development expert who creates complex, believable characters with rich backstories and clear motivations."
      },
      blog_post: {
        name: "Blog Post",
        description: "Engaging blog posts that inform, entertain, and drive traffic",
        role: "You are a content marketing expert who creates blog posts that rank well in search and engage readers."
      },
      social_media_caption: {
        name: "Social Media Caption",
        description: "Engaging captions that drive interaction and build community", 
        role: "You are a social media strategist who creates captions that spark conversations and build engaged communities."
      },
      product_description: {
        name: "Product Description",
        description: "Compelling product descriptions that convert browsers into buyers",
        role: "You are a copywriting expert who writes product descriptions that highlight benefits and drive conversions."
      },
      creative_brief: {
        name: "Creative Brief",
        description: "Clear creative briefs that guide design and content teams",
        role: "You are a creative director who writes briefs that inspire great work and align teams."
      }
    },
    video: {
      youtube_script: {
        name: "YouTube Video Script",
        description: "Engaging YouTube scripts that capture attention and drive viewer engagement",
        role: "You are an experienced YouTube content creator who understands how to structure videos for maximum engagement and subscriber growth."
      },
      tiktok_script: {
        name: "TikTok Video Script",
        description: "Short-form video scripts that go viral and build followings",
        role: "You are a TikTok content creator who understands viral trends and creates engaging short-form content."
      },
      podcast_outline: {
        name: "Podcast Episode Outline", 
        description: "Structured podcast outlines that keep episodes focused and engaging",
        role: "You are a podcast producer who creates outlines that help hosts deliver valuable, engaging episodes."
      },
      video_ad_script: {
        name: "Video Advertisement Script",
        description: "Persuasive video ad scripts that drive conversions and sales",
        role: "You are an advertising specialist who creates video scripts that capture attention and drive measurable results."
      },
      tutorial_script: {
        name: "Tutorial Video Script",
        description: "Educational video scripts that teach complex topics clearly",
        role: "You are an educational content creator who breaks down complex topics into digestible, actionable lessons."
      },
      webinar_outline: {
        name: "Webinar Presentation Outline",
        description: "Structured webinar outlines that educate and convert attendees", 
        role: "You are a webinar strategist who creates presentations that provide value while generating business results."
      }
    },
    social: {
      instagram_post: {
        name: "Instagram Post & Caption",
        description: "Engaging Instagram content that drives likes, comments, and meaningful engagement",
        role: "You are a social media expert who creates Instagram content that drives authentic engagement and builds community."
      },
      linkedin_post: {
        name: "LinkedIn Professional Post",
        description: "Professional LinkedIn content that builds authority and drives business connections", 
        role: "You are a LinkedIn content strategist who helps professionals build their personal brand and generate business opportunities."
      },
      twitter_thread: {
        name: "Twitter Thread",
        description: "Engaging Twitter threads that educate and build following",
        role: "You are a Twitter content creator who understands how to use threads to share valuable information and grow your audience."
      },
      facebook_ad_copy: {
        name: "Facebook Ad Copy",
        description: "Compelling Facebook ad copy that drives clicks and conversions",
        role: "You are a Facebook advertising specialist who writes ad copy that captures attention and drives measurable results."
      },
      instagram_story: {
        name: "Instagram Story Series",
        description: "Engaging Instagram story content that drives interaction and builds connection",
        role: "You are an Instagram story strategist who creates content that keeps audiences engaged and coming back for more."
      },
      social_media_strategy: {
        name: "Social Media Strategy", 
        description: "Comprehensive social media strategies that align with business goals",
        role: "You are a social media strategist who develops comprehensive plans that turn social presence into business results."
      }
    },
    career: {
      resume_summary: {
        name: "Resume Professional Summary",
        description: "Compelling resume summaries that capture recruiter attention and highlight key qualifications",
        role: "You are a career coach and resume expert who helps professionals create summaries that get interviews."
      },
      cover_letter: {
        name: "Cover Letter", 
        description: "Personalized cover letters that connect your experience to specific job requirements",
        role: "You are a career strategist who writes cover letters that get candidates noticed and invited for interviews."
      },
      linkedin_headline: {
        name: "LinkedIn Headline Optimization",
        description: "Attention-grabbing LinkedIn headlines that improve profile visibility and attract opportunities",
        role: "You are a personal branding expert who optimizes LinkedIn profiles to attract opportunities and build professional networks."
      },
      interview_prep: {
        name: "Interview Question Responses", 
        description: "Structured responses to common interview questions using proven frameworks",
        role: "You are an interview coach who helps candidates prepare compelling responses that demonstrate their qualifications and fit."
      },
      networking_message: {
        name: "Professional Networking Message",
        description: "Effective networking messages that build relationships and open doors",
        role: "You are a networking strategist who helps professionals build meaningful connections that advance their careers."
      },
      performance_review: {
        name: "Performance Review Self-Assessment",
        description: "Strategic self-assessments that highlight achievements and set up promotion discussions",
        role: "You are a career advancement coach who helps professionals position themselves for promotions and recognition."
      }
    },
    business: {
      business_plan: {
        name: "Business Plan Executive Summary",
        description: "Compelling executive summaries that capture investor attention and communicate business potential",
        role: "You are a business strategy consultant who helps entrepreneurs create business plans that secure funding and partnerships."
      },
      investor_pitch: {
        name: "Investor Pitch Deck Content",
        description: "Persuasive pitch deck content that secures funding and strategic partnerships", 
        role: "You are a startup advisor who helps entrepreneurs create pitch decks that win over investors and secure funding."
      },
      market_analysis: {
        name: "Market Research Report",
        description: "Comprehensive market analysis that informs strategic business decisions",
        role: "You are a market research analyst who provides insights that help businesses make informed strategic decisions."
      },
      product_launch: {
        name: "Product Launch Strategy", 
        description: "Comprehensive launch plans that maximize market impact and adoption",
        role: "You are a product marketing expert who develops launch strategies that drive awareness, adoption, and revenue."
      },
      competitive_analysis: {
        name: "Competitive Analysis Report",
        description: "Strategic competitive intelligence that identifies opportunities and threats",
        role: "You are a competitive intelligence analyst who helps businesses understand their competitive landscape and identify strategic opportunities."
      },
      sales_strategy: {
        name: "Sales Strategy Development",
        description: "Comprehensive sales strategies that drive revenue growth and market expansion",
        role: "You are a sales strategy expert who helps businesses develop systematic approaches to revenue generation and customer acquisition."
      }
    }
  };

  document.addEventListener('DOMContentLoaded', () => {
    console.log('🚀 ThinkPrompt initializing...');
    
    // Check if all required elements exist
    const requiredElements = [
      'templatesSection', 'contentSection', 'formSection', 
      'completionStatus', 'completionStatusBottom'
    ];
    
    const missingElements = requiredElements.filter(id => !document.getElementById(id));
    if (missingElements.length > 0) {
      console.error('Missing required elements:', missingElements);
    }
    
    // Check if managers are defined
    if (typeof StateManager === 'undefined') {
      console.error('StateManager not defined');
    }
    if (typeof FormManager === 'undefined') {
      console.error('FormManager not defined');
    }
    if (typeof QualityManager === 'undefined') {
      console.error('QualityManager not defined');
    }
    if (typeof ContentManager === 'undefined') {
      console.error('ContentManager not defined');
    }
    
    try {
      initializeCategoryTabs();
      initializeStarterTabs();
      initializeFormListeners();
      initializeLibrarySearch();
      initializeLibraryButtons();
      
      QualityManager.updateDisplay();
      
      console.log('✅ ThinkPrompt ready!');
    } catch (error) {
      console.error('Error during initialization:', error);
    }
  });
</script>
</body>
</html>